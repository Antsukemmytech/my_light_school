{% extends 'base.html' %}

{% block content %}
  <h1>Add Results</h1>

  <form method="post">
    {% csrf_token %}
      <label>Session:</label>
    <select id="session" name="session">
        {% for session in sessions %}
            <option value="{{ session.1 }}">{{ session.0 }}</option>
        {% endfor %}
    </select>

    <label>Class:</label>
    <select id="class" name="class">
      {% for class in classes %}
        <option value="{{ class.id }}">{{ class.name }}</option>
      {% endfor %}
    </select>

    <label>Subject:</label>
    <select id="subject" name="subject">
      {% for subject in subjects %}
        <option value="{{ subject.id }}">{{ subject.name }}</option>
      {% endfor %}
    </select>

    <button type="submit" name="view_students">View Students</button>
  </form>

  {% if students %}
    <h2>Students in {{ student_class.name }} - {{ subject.name }} ({{ session }})</h2>
    <form method="post">
      {% csrf_token %}
      <input type="hidden" name="class" value="{{ student_class.id }}">
      <input type="hidden" name="subject" value="{{ subject.id }}">
      <input type="hidden" name="session" value="{{ session }}">

      {% for student in students %}
        <h3>{{ student.surname }} {{ student.first_name }} {{ student.other_names }}</h3>
        <label>CA1:</label>
        <input type="number" name="ca1_{{ student.id }}" max="20">

        <label>CA2:</label>
        <input type="number" name="ca2_{{ student.id }}" max="20">

        <label>Exam:</label>
        <input type="number" name="exam_{{ student.id }}" max="60">
      {% endfor %}

      <button type="submit">Save Scores</button>
    </form>
  {% endif %}

{% endblock %}